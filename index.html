<!DOCTYPE html>
<html lang="ja">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4B7PGRYJNT"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-4B7PGRYJNT');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="科学的なシミュレーションを行うための教育用プログラムです。科学の面白さを伝えるために開発しています。">
    <title>自然と科学</title>
    <link rel="stylesheet" href="style.css?v=20260111">
    <link rel="stylesheet" href="sort.css">
    <link rel="stylesheet" href="mobile.css" id="responsive-css" media="(max-width: 768px)">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar: Info & Stats -->
        <aside class="sidebar glass-panel">
            <h1>自然と科学 🧪</h1>

            <nav class="main-nav">
                <button id="nav-field" class="nav-btn active">🏞️ 採取フィールド</button>
                <button id="nav-lab" class="nav-btn">⚗️ 合成ラボ</button>
                <button id="nav-book" class="nav-btn">📖 図鑑</button>
                <button id="nav-shop" class="nav-btn" style="display:none;">🏪 交換所</button>
            </nav>

            <div class="stats">
                <p>発見数: <span id="discovery-count">0</span> / <span id="total-count">??</span></p>
                <div
                    style="margin: 5px 0; width: 100%; background: rgba(0,0,0,0.1); border-radius: 5px; overflow: hidden; height: 12px; position: relative;">
                    <div id="sidebar-progress-bar"
                        style="width: 0%; height: 100%; background: linear-gradient(90deg, #4caf50, #81c784); transition: width 0.5s ease;">
                    </div>
                    <span id="sidebar-progress-text"
                        style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 0.65rem; color: #333; font-weight: bold; text-shadow: 0 0 2px rgba(255,255,255,0.8);">0%</span>
                </div>
                <div class="next-goal"
                    style="margin-top: 15px; padding: 10px; background: rgba(255,255,255,0.5); border-radius: 8px; font-size: 0.85rem; border: 1px dashed #81c784;">
                    <strong>🎯 次の目標:</strong>
                    <div id="next-civ-goal" style="margin-top: 5px; color: #2e7d32; font-weight: bold;">---</div>
                </div>
                <button id="nav-settings" class="nav-btn" style="margin-top: 10px; border: 1px dashed #ccc;">⚙️
                    設定</button>
            </div>

            <div id="message-log" class="message-log"></div>
        </aside>

        <!-- Main Workspace Areas (Switched via JS) -->
        <main class="workspace">

            <!-- VIEW 1: Exploration Field -->
            <div id="view-field" class="view-panel active">
                <div class="field-container glass-panel">
                    <div class="field-header">
                        <h2>採取フィールド</h2>
                        <p>自然をクリックして素材を集めよう</p>
                    </div>

                    <div class="nature-scene">
                        <!-- Clickable Areas -->

                        <div class="gather-spot water-spot" data-id="water" title="海水を汲む / 貝殻を拾う">🌊 海</div>
                        <div class="gather-spot forest-spot" data-id="forest" title="森を探索する">🌲 森</div>
                        <div class="gather-spot earth-spot" data-id="land" title="土を掘る">🌱 大地</div>
                        <div class="gather-spot tree-spot" data-id="air" title="空を観察する">💨 空</div>
                        <div class="gather-spot sun-spot" data-id="sun" title="日光を集める">☀️ 太陽</div>
                        <!-- COVE Added -->
                        <div class="gather-spot cave-spot" data-id="ore" title="鉱石を採掘する">⛏️ 洞窟</div>
                        <div class="gather-spot onsen-spot" data-id="onsen" title="硫黄を採る">♨️ 温泉</div>
                        <div class="gather-spot river-spot" data-id="river" title="砂金を探す">🌊 川
                        </div>
                        <div class="gather-spot home-spot" data-id="home" title="生活の痕跡">🏠 家</div>
                        <div class="gather-spot oil-spot" data-id="oil" title="原油を採掘する" style="display:none;">
                            🛢️ 油田
                        </div>
                        <div class="gather-spot foreign-spot" data-id="foreign" title="世界へ旅立つ"
                            style="display:none; background: linear-gradient(135deg, #42a5f5, #1e88e5); color:white;">🚢
                            出航</div>


                        <!-- Japan Local Spots -->
                        <div class="gather-spot coral-spot" data-id="coral_reef" title="サンゴ礁に潜る"
                            style="display:none; background: #00bcd4; color:white;">🪸 サンゴ礁</div>
                        <div class="gather-spot sugar-spot" data-id="sugarcane_field" title="サトウキビを刈る"
                            style="display:none; background: #8bc34a; color:white;">🎋 キビ畑</div>
                        <div class="gather-spot snow-spot" data-id="snow_field" title="雪原を歩く"
                            style="display:none; background: #e0f7fa; color:#006064;">❄️ 雪原</div>
                        <div class="gather-spot coal-spot" data-id="coal_mine" title="石炭を掘る"
                            style="display:none; background: #212121; color:white;">⛏️ 炭鉱</div>
                        <div class="gather-spot gold-spot" data-id="gold_mine" title="金を掘る"
                            style="display:none; background: #ffca28; color:black; border: 1px solid #ff6f00;">⛏️ 金山
                        </div>

                        <!-- Southeast Asia Spots -->
                        <div class="gather-spot jungle-spot" data-id="jungle" title="ゴムノキを探す"
                            style="display:none; background: #66bb6a; color:white;">🌳 密林</div>
                        <div class="gather-spot spice-spot" data-id="spice_field" title="香辛料を探す"
                            style="display:none; background: #ffa726; color:white;">🌶️ 香辛料の森</div>

                        <!-- America Spots -->
                        <div class="gather-spot corn-spot" data-id="corn_field" title="トウモロコシを収穫する"
                            style="display:none; background: #fbc02d; color:black;">🌽 大農園</div>
                        <div class="gather-spot oil-spot" data-id="oil_field" title="石油を採掘する"
                            style="display:none; background: #3e2723; color:white;">🛢️ テキサス油田</div>

                        <!-- South America Spots -->
                        <div class="gather-spot andes-spot" data-id="andes" title="ジャガイモを探す"
                            style="display:none; background: #795548; color:white;">⛰️ アンデス山脈</div>
                        <div class="gather-spot amazon-spot" data-id="amazon" title="カカオを探す"
                            style="display:none; background: #388e3c; color:white;">🍫 アマゾン川</div>
                        <div class="gather-spot mine-spot" data-id="araxa_mine" title="ニオブを採掘する"
                            style="display:none; background: #5d4037; color:white;">⛏️ アラシャ鉱山</div>
                        <div class="gather-spot salt-lake-spot" data-id="salt_lake" title="塩を採取する"
                            style="display:none; background: #e0f7fa; color:#006064;">🧂 塩湖</div>
                        <div class="gather-spot bolivia-spot" data-id="bolivia_mine" title="輝蒼鉛鉱を採掘する"
                            style="display:none; background: #607d8b; color:white;">⛏️ ボリビア鉱山</div>

                        <!-- Europe Spots -->
                        <div class="gather-spot olive-spot" data-id="olive_grove" title="オリーブを探す"
                            style="display:none; background: #c0ca33; color:white;">🫒 オリーブ畑</div>
                        <div class="gather-spot coast-spot" data-id="spanish_coast" title="蛍石を探す"
                            style="display:none; background: #03a9f4; color:white;">🏖️ 地中海沿岸</div>

                        <!-- Australia Spots -->
                        <div class="gather-spot desert-spot" data-id="red_desert" title="ボーキサイトを採掘する"
                            style="display:none; background: #d32f2f; color:white;">🏜️ 赤い荒野</div>

                        <!-- Turkey Spot -->
                        <div class="gather-spot turkey-spot" data-id="turkey" title="ホウ砂を探す"
                            style="display:none; background: #e0f2f1; color:#004d40; border: 1px solid #00695c;">🦃
                            アナトリア
                        </div>

                        <!-- China Spot -->
                        <div class="gather-spot china-spot" data-id="china" title="中国を探索する"
                            style="display:none; background: #ffcdd2; color:#bf360c;">🐼 竹林</div>
                        <div class="gather-spot china-mine-spot" data-id="china_mine" title="レアアースを採掘する"
                            style="display:none; background: #5d4037; color:white; border: 1px solid #795548;">🏔️ 五台山
                        </div>
                        <div class="gather-spot uyghur-spot" data-id="uyghur_field" title="綿花を摘む"
                            style="display:none; background: #fff3e0; color:#5d4037; border: 1px solid #ffab91;">🏜️
                            ウイグル
                        </div>

                        <!-- South Africa Spots -->
                        <div class="gather-spot savannah-spot" data-id="savannah" title="レアメタルを探す"
                            style="display:none; background: #ffca28; color:black;">🦁 サバンナ</div>

                        <!-- Moon Spots -->
                        <div class="gather-spot crater-spot" data-id="crater" title="月面を調査する"
                            style="display:none; background: #37474f; color:white; border: 1px solid #78909c;">🌕 クレーター
                        </div>
                        <div class="gather-spot mars-spot" data-id="mars_surface" title="火星を探査する"
                            style="display:none; background: #d84315; color:white; border: 1px solid #ff5722;">🪐 火星地表
                        </div>

                        <!-- Chemical Plant (Anthraquinone Method) -->
                        <div class="gather-spot plant-spot" data-id="h2o2_plant" title="過酸化水素を補給する"
                            style="display:none; background: #00bcd4; color:white; border: 1px solid #00acc1;">🏭 化学プラント
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 2: Crafting Lab -->
            <div id="view-lab" class="view-panel" style="display: none;">

                <!-- Section 1: Crafting -->
                <div id="crafting-section" class="machine-section glass-panel">
                    <div class="machine-title">合成ラボ</div>

                    <div class="slots-container">
                        <div class="slot-wrapper">
                            <div id="slot-1" class="element-slot empty" data-index="0">
                                <span class="slot-placeholder">素材A</span>
                            </div>
                            <div class="lock-btn" id="lock-btn-1" onclick="toggleLock(1)">🔓</div>
                        </div>
                        <div class="operator">+</div>
                        <div class="slot-wrapper">
                            <div id="slot-2" class="element-slot empty" data-index="1">
                                <span class="slot-placeholder">素材B</span>
                            </div>
                            <div class="lock-btn" id="lock-btn-2" onclick="toggleLock(2)">🔓</div>
                        </div>
                        <div class="operator">+</div>
                        <div class="slot-wrapper">
                            <div id="slot-3" class="element-slot empty" data-index="2">
                                <span class="slot-placeholder">素材C</span>
                            </div>
                            <div class="lock-btn" id="lock-btn-3" onclick="toggleLock(3)">🔓</div>
                        </div>
                        <div class="operator">+</div>
                        <div class="slot-wrapper">
                            <div id="slot-4" class="element-slot empty" data-index="3">
                                <span class="slot-placeholder">素材D</span>
                            </div>
                            <div class="lock-btn" id="lock-btn-4" onclick="toggleLock(4)">🔓</div>
                        </div>
                        <div class="operator">+</div>
                        <div class="slot-wrapper">
                            <div id="slot-5" class="element-slot empty" data-index="4">
                                <span class="slot-placeholder">素材E</span>
                            </div>
                            <div class="lock-btn" id="lock-btn-5" onclick="toggleLock(5)">🔓</div>
                        </div>
                        <div class="operator">=</div>
                        <div class="slot-wrapper">
                            <div id="slot-result" class="element-slot result locked">
                                <span class="slot-placeholder">?</span>
                            </div>
                        </div>
                    </div>

                    <div class="control-area">
                        <button id="craft-btn" class="action-btn">合成する！</button>
                        <button id="reset-slots-btn" class="text-btn">クリア</button>
                    </div>
                </div>

                <!-- Section 2: Smelter -->
                <div id="smelter-section" class="machine-section glass-panel" style="margin-top: 20px;">
                    <div class="machine-title" draggable="true" style="cursor: grab;">製錬所 ≡</div>
                    <div class="refinery-container">
                        <div class="refinery-info">
                            <p>鉱石・燃料(木炭/コークス)・火・土器を使って金属を製錬する。</p>
                        </div>
                        <button id="refine-btn" class="action-btn"
                            style="background: #e65100; box-shadow: 0 4px 10px rgba(230, 81, 0, 0.3);">🔥 製錬</button>
                    </div>
                </div>

                <!-- Section 3: Distillery -->
                <div id="distillery-section" class="machine-section glass-panel" style="margin-top: 20px;">
                    <div class="machine-title" draggable="true" style="margin-bottom: 10px; cursor: grab;">蒸留所 ≡</div>
                    <div class="refinery-container">
                        <div class="refinery-info">
                            <p>液体を土器で沸騰させて成分を分離する。</p>
                            <p style="font-size: 0.8rem; color: #d32f2f;">※[土器]と[火]が必要</p>
                        </div>
                        <button id="distill-btn" class="action-btn"
                            style="background: #29b6f6; box-shadow: 0 4px 10px rgba(41, 182, 246, 0.3);">💧 蒸留</button>
                    </div>
                </div>

                <!-- Section 4: Carbonization Facility -->
                <div id="carbonization-section" class="machine-section glass-panel" style="margin-top: 20px;">
                    <div class="machine-title" draggable="true" style="margin-bottom: 10px; cursor: grab;">乾留所 ≡</div>
                    <div class="refinery-container">
                        <div class="refinery-info">
                            <p>火を使って木材・石炭・薬品を蒸し焼き（乾留）にする。</p>
                        </div>
                        <button id="carbonize-btn" class="action-btn"
                            style="background: #4e342e; box-shadow: 0 4px 10px rgba(78, 52, 46, 0.3);">⬛ 乾留</button>
                    </div>
                </div>

                <!-- Section 5: Extraction Facility -->
                <div id="extraction-section" class="machine-section glass-panel" style="margin-top: 20px;">
                    <div class="machine-title" draggable="true" style="margin-bottom: 10px; cursor: grab;">抽出所 ≡</div>
                    <div class="refinery-container">
                        <div class="refinery-info">
                            <p>化学反応を利用して混合物から成分を取り出す。</p>
                        </div>
                        <button id="extract-btn" class="action-btn"
                            style="background: #66bb6a; box-shadow: 0 4px 10px rgba(102, 187, 106, 0.3);">⚗️ 抽出
                            (化学分離)</button>
                    </div>
                </div>

                <!-- Section 6: Oil Refinery (Hidden by default) -->
                <div id="oil-refinery-section" class="machine-section glass-panel"
                    style="margin-top: 20px; display: none;">
                    <div class="machine-title" draggable="true" style="margin-bottom: 10px; cursor: grab;">製油所 ≡</div>
                    <div class="refinery-container">
                        <div class="refinery-info">
                            <p>蒸留塔を使って原油を様々な石油製品に分離する。</p>
                            <p style="font-size: 0.8rem; color: #555;">※[蒸留塔]が必要</p>
                        </div>
                        <button id="oil-refine-btn" class="action-btn"
                            style="background: #ef5350; box-shadow: 0 4px 10px rgba(239, 83, 80, 0.3);">🛢️
                            石油精製</button>
                    </div>
                </div>

                <!-- Section 7: Electric Refinery (Hidden by default) -->
                <div id="electric-refinery-section" class="machine-section glass-panel"
                    style="margin-top: 20px; display: none;">
                    <div class="machine-title" draggable="true" style="margin-bottom: 10px; cursor: grab;">⚡ 電気精錬所 ≡
                    </div>
                    <div class="refinery-container">
                        <div class="refinery-info">
                            <p>水力発電による無限電力を使用し、高度な素材を一括生産する。</p>
                            <p style="font-size: 0.8rem; color: #1976d2;">※電気消費なし</p>
                        </div>
                        <button id="electric-refine-btn" class="action-btn"
                            style="background: #fb8c00; box-shadow: 0 4px 10px rgba(251, 140, 0, 0.3);">⚡
                            電気精錬</button>
                    </div>
                </div>

                <!-- Section 8: Arc Furnace (Hidden by default) -->
                <div id="arc-furnace-section" class="machine-section glass-panel"
                    style="margin-top: 20px; display: none;">
                    <div class="machine-title" draggable="true" style="margin-bottom: 10px; cursor: grab;">⚡ アーク溶解炉 ≡
                    </div>
                    <div class="refinery-container">
                        <div class="refinery-info">
                            <p>電気アークの超高温で金属を溶解・精錬します。</p>
                            <p style="font-size: 0.8rem; color: #d84315;">※電力と素材が必要</p>
                        </div>
                        <button id="arc-melt-btn" class="action-btn"
                            style="background: #e53935; box-shadow: 0 4px 10px rgba(229, 57, 53, 0.3);">⚡
                            アーク溶解</button>
                    </div>
                </div>

            </div>



            <!-- VIEW 3: Encyclopedia -->
            <div id="view-book" class="view-panel" style="display: none;">
                <div class="book-container glass-panel">
                    <div class="book-header" style="text-align: center;">
                        <h2 style="color: #2e7d32; margin-bottom: 5px;">図鑑</h2>
                        <p style="color: #666; font-size: 0.9rem;">発見した要素の記録</p>
                    </div>

                    <!-- Civilization Info Card (Updated Design) -->
                    <div id="enc-civ-info" class="civ-info-card">
                        <!-- Content injected via JS -->
                        読み込み中...
                    </div>

                    <!-- Encyclopedia Progress Bar -->
                    <div style="margin: 0 10px 20px; text-align: center;">
                        <div
                            style="background: #e0e0e0; border-radius: 10px; height: 16px; width: 60%; margin: 0 auto; position: relative; overflow: hidden;">
                            <div id="enc-progress-bar"
                                style="width: 0%; height: 100%; background: #4caf50; transition: width 0.5s ease;">
                            </div>
                            <span id="enc-progress-text"
                                style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 0.7rem; color: #333; font-weight: bold;">0.00%</span>
                        </div>
                    </div>

                    <!-- Tabs (Re-added with updated design) -->
                    <div class="book-tabs"
                        style="display: flex; justify-content: center; gap: 20px; margin-bottom: 25px;">
                        <button id="tab-elements" class="action-btn"
                            style="border-radius: 20px; padding: 5px 30px; background: #2e7d32; box-shadow: 0 2px 5px rgba(0,0,0,0.2); font-weight: bold;">要素</button>
                        <button id="tab-industry" class="text-btn"
                            style="font-weight: bold; color: #666; font-size: 1rem;">工業</button>
                    </div>

                    <div class="search-bar" style="margin: 0 auto 10px; max-width: 300px;">
                        <div style="position: relative;">
                            <span
                                style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: #888;">🔍</span>
                            <input type="text" id="book-search-input" placeholder="名前で検索..."
                                style="width: 100%; padding: 10px 10px 10px 35px; border-radius: 20px; border: 1px solid #ddd; outline: none; text-align: left;">
                        </div>
                    </div>

                    <div class="sort-controls" style="text-align: center; margin-bottom: 20px; padding: 0;">
                        <button id="sort-id-btn" class="text-btn"
                            style="color: #666; font-size: 0.85rem; margin: 0 10px; font-weight: bold;">ID順</button>
                        <button id="sort-emoji-btn" class="text-btn"
                            style="color: #999; font-size: 0.85rem; margin: 0 10px;">絵文字順</button>
                    </div>
                    <div id="encyclopedia-grid" class="encyclopedia-grid">
                        <!-- Items injected here -->
                    </div>
                </div>
            </div>


            <!-- VIEW 4: Shop -->
            <div id="view-shop" class="view-panel" style="display: none;">
                <div class="shop-container glass-panel">
                    <div class="shop-header">
                        <h2>交換所</h2>
                        <p>発見したアイテムを売買できます</p>
                        <div class="wallet-display"
                            style="background: rgba(255,215,0,0.2); padding: 5px 15px; border-radius: 20px; text-align: center; margin-top: 10px; border: 1px solid gold;">
                            <span style="font-size: 1.2rem;">💰 所持金: </span>
                            <span id="player-money"
                                style="font-size: 1.5rem; font-weight: bold; color: #d84315;">0</span>
                            <span style="font-size: 1rem;"> G</span>
                        </div>
                    </div>

                    <div class="shop-tabs" style="display: flex; gap: 10px; margin: 15px 0 10px;">
                        <button id="tab-buy" class="action-btn small active" style="flex: 1;">買う</button>
                        <button id="tab-sell" class="action-btn small secondary" style="flex: 1;">売る</button>
                    </div>

                    <div class="search-bar" style="margin: 0 auto 10px; max-width: 300px;">
                        <div style="position: relative;">
                            <span
                                style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: #888;">🔍</span>
                            <input type="text" id="shop-search-input" placeholder="アイテムを検索..."
                                style="width: 100%; padding: 8px 10px 8px 30px; border-radius: 20px; border: 1px solid #ddd; outline: none; text-align: left; font-size: 0.9rem;">
                        </div>
                    </div>

                    <div class="sort-controls" style="text-align: center; margin-bottom: 15px; padding: 0;">
                        <button id="shop-sort-id-btn" class="text-btn"
                            style="color: #333; font-size: 0.8rem; margin: 0 5px; font-weight: bold;">ID順</button> |
                        <button id="shop-sort-price-asc-btn" class="text-btn"
                            style="color: #999; font-size: 0.8rem; margin: 0 5px;">安い順</button> |
                        <button id="shop-sort-price-desc-btn" class="text-btn"
                            style="color: #999; font-size: 0.8rem; margin: 0 5px;">高い順</button>
                    </div>

                    <div id="shop-grid" class="shop-grid"
                        style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px; max-height: 50vh; overflow-y: auto; padding: 5px;">
                        <!-- Items injected here -->
                    </div>
                </div>
            </div>

        </main>

        <!-- Bottom Panel: Inventory (Shared) -->
        <section class="inventory glass-panel">
            <div class="inventory-header">
                <h2>倉庫</h2>
                <div style="margin-left: auto; display: flex; gap: 10px; align-items: center;">
                    <input type="text" id="inventory-search" placeholder="🔍 検索..."
                        style="padding: 5px 10px; border-radius: 15px; border: none; font-size: 0.9rem; width: 150px; background: rgba(255,255,255,0.8); box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);">
                    <button id="manual-sort-btn" class="text-btn"
                        style="color: #666; font-size: 0.8rem; background: rgba(255,255,255,0.5); padding: 4px 8px; border-radius: 4px;">🖐️
                        並べ替え</button>
                    <span class="inventory-hint">クリックで装置にセット</span>
                </div>
            </div>
            <div id="element-list" class="element-list">
                <!-- Elements injected here -->
            </div>
        </section>
    </div>


    <!-- Element Details Modal -->
    <div id="detail-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content glass-panel">
            <span id="close-modal" class="close-btn">&times;</span>
            <div id="modal-body">
                <!-- Content injected via JS -->
            </div>
        </div>
    </div>

    <!-- World Map Modal -->
    <div id="map-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content glass-panel" style="max-width: 600px; text-align: center;">
            <span id="close-map" class="close-btn">&times;</span>
            <h2>🗺️ 世界地図</h2>
            <p>行き先を選択してください</p>
            <div class="map-container"
                style="margin-top:20px; display:grid; grid-template-columns: 1fr 1fr; gap:20px; padding: 20px;">
                <!-- Local -->
                <div id="dest-local" class="map-destination"
                    style="border: 2px solid #ccc; padding: 20px; border-radius: 10px; cursor: pointer; background: #e8f5e9;">
                    <div style="font-size: 3rem;">🗾</div>
                    <h3>日本 (拠点)</h3>
                    <p style="font-size: 0.8rem; color: #555;">いつもの採取場所</p>
                </div>
                <!-- Okinawa -->
                <div id="dest-okinawa" class="map-destination"
                    style="border: 2px solid #00bcd4; padding: 20px; border-radius: 10px; cursor: pointer; background: #e0f7fa;">
                    <div style="font-size: 3rem;">🌺</div>
                    <h3>沖縄</h3>
                    <p style="font-size: 0.8rem; color: #555;">南国の海とサトウキビ</p>
                </div>
                <!-- Hokkaido -->
                <div id="dest-hokkaido" class="map-destination"
                    style="border: 2px solid #90a4ae; padding: 20px; border-radius: 10px; cursor: pointer; background: #eceff1;">
                    <div style="font-size: 3rem;">❄️</div>
                    <h3>北海道</h3>
                    <p style="font-size: 0.8rem; color: #555;">北の大地と炭鉱</p>
                </div>
                <!-- Kagoshima -->
                <div id="dest-kagoshima" class="map-destination"
                    style="border: 2px solid #ffcc80; padding: 20px; border-radius: 10px; cursor: pointer; background: #fff3e0;">
                    <div style="font-size: 3rem;">🌋</div>
                    <h3>鹿児島</h3>
                    <p style="font-size: 0.8rem; color: #555;">桜島と黄金の鉱脈</p>
                </div>
                <!-- China (New) -->
                <div id="dest-china" class="map-destination"
                    style="border: 2px solid #d32f2f; padding: 20px; border-radius: 10px; cursor: pointer; background: #ffebee;">
                    <div style="font-size: 3rem;">🐼</div>
                    <h3>中国</h3>
                    <p style="font-size: 0.8rem; color: #555;">火薬と茶の歴史</p>
                </div>
                <!-- Foreign -->
                <div id="dest-foreign" class="map-destination"
                    style="border: 2px solid #2196f3; padding: 20px; border-radius: 10px; cursor: pointer; background: #e3f2fd;">
                    <div style="font-size: 3rem;">🌏</div>
                    <h3>東南アジア</h3>
                    <p style="font-size: 0.8rem; color: #555;">ゴムノキと香辛料の産地</p>
                </div>
                <!-- America -->
                <div id="dest-america" class="map-destination"
                    style="border: 2px solid #81c784; padding: 20px; border-radius: 10px; cursor: pointer; background: #f1f8e9;">
                    <div style="font-size: 3rem;">🤠</div>
                    <h3>北米</h3>
                    <p style="font-size: 0.8rem; color: #555;">未知の穀物を求めて</p>
                </div>
                <!-- South America -->
                <div id="dest-south-america" class="map-destination"
                    style="border: 2px solid #8d6e63; padding: 20px; border-radius: 10px; cursor: pointer; background: #efebe9;">
                    <div style="font-size: 3rem;">🦙</div>
                    <h3>南米</h3>
                    <p style="font-size: 0.8rem; color: #555;">アンデス山脈とアマゾン川</p>
                </div>
                <!-- Europe (Spain) -->
                <div id="dest-europe" class="map-destination"
                    style="border: 2px solid #ffeb3b; padding: 20px; border-radius: 10px; cursor: pointer; background: #fffde7;">
                    <div style="font-size: 3rem;">🐂</div>
                    <h3>スペイン</h3>
                    <p style="font-size: 0.8rem; color: #555;">太陽と情熱の国</p>
                </div>
                <!-- Turkey -->
                <div id="dest-turkey" class="map-destination"
                    style="border: 2px solid #00897b; padding: 20px; border-radius: 10px; cursor: pointer; background: #e0f2f1;">
                    <div style="font-size: 3rem;">🦃</div>
                    <h3>トルコ</h3>
                    <p style="font-size: 0.8rem; color: #555;">アナトリアの豊富な鉱物</p>
                </div>
                <!-- Australia -->
                <div id="dest-australia" class="map-destination"
                    style="border: 2px solid #ff5722; padding: 20px; border-radius: 10px; cursor: pointer; background: #fbe9e7;">
                    <div style="font-size: 3rem;">🦘</div>
                    <h3>オーストラリア</h3>
                    <p style="font-size: 0.8rem; color: #555;">広大な赤い大地</p>
                </div>
                <!-- South Africa -->
                <div id="dest-south-africa" class="map-destination"
                    style="border: 2px solid #ffca28; padding: 20px; border-radius: 10px; cursor: pointer; background: #fff8e1;">
                    <div style="font-size: 3rem;">💎</div>
                    <h3>南アフリカ</h3>
                    <p style="font-size: 0.8rem; color: #555;">鉱物資源の宝庫</p>
                </div>
            </div>

            <!-- Rocket Map Section -->
            <div id="rocket-map-section"
                style="display:none; border-top:1px solid #ddd; margin-top:20px; padding-top:10px; width: 100%;">
                <h3 style="margin:0 0 10px 0;">宇宙</h3>
                <div class="map-grid" style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
                    <div id="dest-moon" class="map-destination"
                        style="border: 2px solid #546e7a; padding: 20px; border-radius: 10px; cursor: pointer; background: #eceff1; text-align: center;">
                        <div style="font-size: 3rem;">🌕</div>
                        <h3>月面</h3>
                        <p style="font-size: 0.8rem; color: #555;">静寂の世界</p>
                    </div>
                    <div id="dest-mars" class="map-destination"
                        style="border: 2px solid #bf360c; padding: 20px; border-radius: 10px; cursor: pointer; background: #fbe9e7; text-align: center;">
                        <div style="font-size: 3rem;">🪐</div>
                        <h3>火星</h3>
                        <p style="font-size: 0.8rem; color: #555;">赤い砂漠の惑星</p>
                    </div>
                </div>
            </div>

            <button id="close-map-btn"
                style="margin-top:20px; padding:10px 20px; background:#ddd; border:none; border-radius:5px; cursor:pointer;">閉じる</button>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="max-width: 400px; padding: 30px; text-align: center;">
            <span class="close-btn" id="close-settings-modal"
                style="position: absolute; top: 15px; right: 15px; font-size: 1.5rem; cursor: pointer;">&times;</span>
            <div style="font-size: 1.5rem; font-weight: bold; margin-bottom: 25px;">⚙️ 設定</div>

            <div
                style="text-align: left; margin-bottom: 25px; padding: 15px; background: rgba(0,0,0,0.03); border-radius: 10px;">
                <h3
                    style="border-bottom: 1px solid #ccc; padding-bottom: 5px; margin-bottom: 15px; font-size: 1rem; color: #555;">
                    💾 データ管理</h3>
                <div style="display: flex; gap: 10px; margin-bottom: 15px; justify-content: center;">
                    <button id="export-save-btn" class="action-btn small" style="flex:1;">📤 保存</button>
                    <button id="import-save-btn" class="action-btn small secondary" style="flex:1;">📥 読込</button>
                </div>
                <div style="text-align: center;">
                    <button id="delete-save-btn" class="text-btn" style="color: #e53935; font-size: 0.85rem;">🗑️
                        データを削除する</button>
                </div>
            </div>

            <div style="text-align: left; padding: 15px; background: rgba(0,0,0,0.03); border-radius: 10px;">
                <h3
                    style="border-bottom: 1px solid #ccc; padding-bottom: 5px; margin-bottom: 15px; font-size: 1rem; color: #555;">
                    🎨 表示設定</h3>
                <div style="display: flex; gap: 10px; margin-bottom: 15px; justify-content: center;">
                    <button id="btn-toggle-lite" class="action-btn small" style="flex:1;">✨ 軽量化</button>
                    <button id="btn-toggle-dark" class="action-btn small secondary" style="flex:1;">🌙 ダーク</button>
                </div>
                <div style="margin-top: 15px; font-size: 0.85rem; text-align: center; color: #777;">
                    <span>レイアウト: </span>
                    <button class="text-btn" id="btn-view-auto" style="margin: 0 5px;">Auto</button> /
                    <button class="text-btn" id="btn-view-pc" style="margin: 0 5px;">PC</button> /
                    <button class="text-btn" id="btn-view-mobile" style="margin: 0 5px;">Mob</button>
                </div>
            </div>

            <div
                style="text-align: left; padding: 15px; background: rgba(0,0,0,0.03); border-radius: 10px; margin-top: 25px;">
                <h3
                    style="border-bottom: 1px solid #ccc; padding-bottom: 5px; margin-bottom: 15px; font-size: 1rem; color: #555;">
                    🎓 ガイド</h3>
                <div style="text-align: center;">
                    <button id="btn-restart-tutorial" class="action-btn small" style="width: 100%;">チュートリアルを再開</button>
                </div>
            </div>

            <p style="font-size: 0.75rem; color: #aaa; margin-top: 30px;">Natural & Science v1.3</p>
        </div>
    </div>

    <script src="gather_data.js"></script>
    <script src="script.js"></script>
</body>

</html>